dat <- read.csv("bikes.csv")
names(dat)
delta_lat <- (dat$latitude_start - dat$latitude_end)
delta_lon <- (dat$longitude_start - dat$longitude_end)
distance <- sqrt( (111*(delta_lat))
distance <- sqrt( (111*(delta_lat))^2 + (111*(delta_lon))^2 )
distance
hist(distance)
dat$distance_km <- distance
library(dplyr)
library(ggplot2)
library(lubridate)
names(dat)
dat %>% mutate(day_month_year = ymd_hms(starttime))
dat %>% mutate(day_month_year = ymd_hms(starttime)) %>% group_by(day_month_year) %>% select(distance, gender, day_month_year)
rm(distance)
dat %>% mutate(day_month_year = ymd_hms(starttime)) %>% group_by(day_month_year) %>% select(distance_km, gender, day_month_year)
dat %>% mutate(day_month_year = ymd_hms(starttime)%>%format("%Y-%m-%d")) %>% group_by(day_month_year) %>% select(distance_km, gender, day_month_year)
dat %>% mutate(day_month_year = ymd_hms(starttime)%>%format("%Y-%m-%d")) %>% group_by(day_month_year,gender) %>% select(distance_km, gender, day_month_year)
dat %>% mutate(day_month_year = ymd_hms(starttime)%>%format("%Y-%m-%d")) %>% group_by(day_month_year) %>% select(distance_km, day_month_year)
dat %>% mutate(day_month_year = ymd_hms(starttime)%>%format("%Y-%m-%d")) %>% group_by(day_month_year) %>% select(distance_km, day_month_year) %>% ggplot(aes(x = ymd(day_month_year), y = distance_km) + geom_line(stat="identity")
dat %>% mutate(day_month_year = ymd_hms(starttime)%>%format("%Y-%m-%d")) %>% group_by(day_month_year) %>% select(distance_km, day_month_year) %>% ggplot(aes(x = ymd(day_month_year), y = distance_km)) + geom_line(stat="identity")
dat %>% mutate(day_month_year = ymd_hms(starttime)%>%format("%Y-%m-%d")) %>% group_by(day_month_year, gender) %>% select(distance_km, day_month_year, gender) %>% ggplot(aes(x = ymd(day_month_year), y = distance_km, fill = gender)) + geom_line(stat="identity")
names(dat)
dat %>% mutate(day_month_year = ymd_hms(starttime)%>%format("%Y-%m-%d")) %>% group_by(day_month_year, gender) %>% select(distance_km, day_month_year, gender, tripduration) %>% ggplot(aes(x = ymd(day_month_year), y = tripduration, fill = gender)) + geom_line(stat="identity")
dat %>% mutate(day_month_year = ymd_hms(starttime)%>%format("%Y-%m-%d")) %>% group_by(day_month_year, gender) %>% summarise(totaltripduration = sum(tripduration)) %>% select(day_month_year, gender, totaltripduration) %>% ggplot(aes(x = ymd(day_month_year), y = totaltripduration, col = gender)) + geom_line(stat="identity")
dat %>% mutate(day_month_year = ymd_hms(starttime)%>%format("%Y-%m-%d")) %>% group_by(day_month_year, gender) %>% summarise(totaltripduration = sum(tripduration)/60000) %>% select(day_month_year, gender, totaltripduration) %>% ggplot(aes(x = ymd(day_month_year), y = totaltripduration, col = gender)) + geom_line(stat="identity") + xlab("Date - dd/mm/yyyy") + ylab("Total trip durations per day (minutes)")
dat$tripduration
dat$starttime - dat$stoptime
dat %>% mutate(day_month_year = ymd_hms(starttime)%>%format("%Y-%m-%d")) %>% group_by(day_month_year, gender) %>% summarise(totaltripduration = sum(tripduration)/60) %>% select(day_month_year, gender, totaltripduration) %>% ggplot(aes(x = ymd(day_month_year), y = totaltripduration, col = gender)) + geom_line(stat="identity") + xlab("Date - dd/mm/yyyy") + ylab("Total trip durations per day (minutes)")
dat %>% mutate(day_month_year = ymd_hms(starttime)%>%format("%Y-%m-%d")) %>% group_by(day_month_year, gender) %>% summarise(totaltripduration = sum(tripduration)/60) %>% select(day_month_year, gender, totaltripduration) %>% ggplot(aes(x = ymd(day_month_year), y = totaltripduration, col = gender)) + geom_line(stat="identity") + xlab("Date - dd/mm/yyyy") + ylab("Total trip durations per day (minutes)")
dat %>% mutate(day_month_year = ymd_hms(starttime)%>%format("%Y-%m-%d")) %>% group_by(day_month_year, gender) %>% summarise(totaltripduration = sum(tripduration)/60) %>% select(day_month_year, gender, totaltripduration) %>% ggplot(aes(x = ymd(day_month_year), y = totaltripduration, col = gender)) + geom_line(stat="identity") + xlab("Date - dd/mm/yyyy") + ylab("Total ride durations per day (minutes)") + geom_title("Bike rides in NYC")
dat %>% mutate(day_month_year = ymd_hms(starttime)%>%format("%Y-%m-%d")) %>% group_by(day_month_year, gender) %>% summarise(totaltripduration = sum(tripduration)/60) %>% select(day_month_year, gender, totaltripduration) %>% ggplot(aes(x = ymd(day_month_year), y = totaltripduration, col = gender)) + geom_line(stat="identity") + xlab("Date - dd/mm/yyyy") + ylab("Total ride durations per day (minutes)") + ggtitle("Bike rides in NYC")
png("ridesduration.png",width=3200,height=1800,res=300)
dat %>% mutate(day_month_year = ymd_hms(starttime)%>%format("%Y-%m-%d")) %>% group_by(day_month_year, gender) %>% summarise(totaltripduration = sum(tripduration)/60) %>% select(day_month_year, gender, totaltripduration) %>% ggplot(aes(x = ymd(day_month_year), y = totaltripduration, col = gender)) + geom_line(stat="identity") + xlab("Date - dd/mm/yyyy") + ylab("Total ride durations per day (minutes)") + ggtitle("Bike rides in NYC")
dev.off()
savehistory("./log.R")
